var Common =
    {
      init: function() {
        this.initWindowMessages();
      },

      initWindowMessages: function()
      {
        window.onmessage = function(evt) {
          if (evt.data == 'print') {
            this.showPrint();
          }
          if (evt.data == 'showExportWindow') {
            this.showExport();
          }
        }.bind(this)
      },

      showPrint: function()
      {
        window.print();
      },

      postActivityMessage: function(action)
      {
        if (window.parent) {
          try {
            window.parent.postMessage(action, '*');
          } catch (e) {
          }
        }
      },
      showExport: function()
      {
        var addSeparator = document.location.search.indexOf('?') !== -1 ? '&' : '?'
        document.location = document.location + addSeparator + 'export=xlsx'; 
      } 
    };

$(document).ready(function() {
  Common.init();
});